<!DOCTYPE html>
<html>

    <body>

        <div class="container-fluid" style="margin-top: 5%">


            <form class="form-inline">

                <div style="width: 100%; margin-top: 20px">
                    <div class="input-group searchcontainer">
                        <input ng-model="search" class="w3-input searchtext" placeholder="Palabra por la que filtrar:"
                               required
                               onkeyup="hidediv(event)" style="font-size: medium">

                    </div>

                    <div class="input-group searchcontainer  " style="display: inline-flex ; width: auto;">

                        <input ng-value="$ctrl.currentpageorganizations" ng-model=$ctrl.currentpageorganizations
                               size="50" class="w3-input searchtext"
                               style="width: 20%" ng-change="$ctrl.changepage($ctrl.currentpageorganizations)">
                        <h5 style="font-size: medium; margin-right: 20px;"> de {{ $ctrl.countorganizations }} </h5>

                        <a href="" class="btn btn-primary material-icons"
                           style="margin: 0px; padding: 0px; width: auto"
                           ng-click="$ctrl.prevorganization()" onmouseup=setTimeout(function(){hidediv(null);},50)>
                            keyboard_arrow_left</a>

                        <a href="" class="btn btn-primary material-icons"
                           style="margin: 0px; padding: 0px; width: auto"
                           ng-click="$ctrl.nextorganization()" onmouseup=setTimeout(function(){hidediv(null);},50)>
                            keyboard_arrow_right</a>
                        <md-radio-group ng-model="$ctrl.orgchange" style="display: flex; margin-left: 10%"
                                        ng-change="$ctrl.onNationChanged($ctrl.orgchange)">

                            <md-radio-button value="ESP" style="margin-left : 10px" class="md-primary">Nacional
                            </md-radio-button>
                            <md-radio-button value="EU" style="margin-left : 10px"> Europeo</md-radio-button>
                            <md-radio-button value="ALL" style="margin-left : 10px">Todo</md-radio-button>

                        </md-radio-group>


                    </div>


                </div>


            </form>


            <ul class="project">

                <div ng-repeat="organization in $ctrl.organizations ">
                    <div class="metricdiv" style="display: flex;" ng-mouseenter="$ctrl.onHoverMetrics(organization)">
                        <a class="metric" href="/www/#!/o{{ organization.id }}" style="display: block">

                                    <span ng-if="organization">
									<div class="proyectcontainer">

										<div ng-repeat="(key, value) in organization | custom:search "
                                             ng-controller="Ctrl">

                                                        <span ng-if="key!='id'">

                                             <span ng-if="isobj(value)== false">

												<span ng-if="value" !="NaN">
													<h3> {{ key }}:

														<span>{{ value }} </span>
													</h3>
												</span>
                                            </span>
                                                        </span>

                                        </div>
                                        <div ng-repeat="(key, value) in organization | custom:search "
                                             ng-controller="Ctrl">
											<span ng-if="isobj(value)== true">

                                                <span ng-if="key!='id'">
                                                    <h3>{{ key }}:</h3></span>
												<div ng-repeat="(key2,value2) in value " style="margin-left: 13%">
													<h3> {{ key2 }}:
														<span>{{ value2 }} </span>
													</h3>
												</div>

                                                <span ng-if="key=='id'">
                                <h3>ID :  <span>{{ value.id }} </span></h3>

                                 </span>
											</span>

										</div>

									</div>
								</span>

                        </a>

                        <div class="buttonmetric">
                            <a href="/www/#!/metric{{ organization.id }}" style="display: flex; width: 100%">
                                <div style="margin-right: 7%">
                                    <h5>Métricas Region: {{ $ctrl.regionName }}</h5>
                                    <p>Nº Empresas: {{ $ctrl.numeroEmpresas }}</p>
                                    <p>Nº Total de Proyectos: {{ $ctrl.numeroProyectosR }}</p>
                                    <p>Nº Medio de Proyectos: {{ $ctrl.numeroProyectosMedioR }}</p>

                                </div>
                                <hr class="style2">
                                <div style="margin-right: 7%">
                                    <h5>Metricas Organizacion: </h5>
                                    <p>Nº de Proyectos: {{ $ctrl.numeroProyectosO }}</p>

                                    <p>% subvencionado: {{ $ctrl.porcentajesubvencionadoO }}</p>


                                </div>
                                <hr class="style2">
                                <div>
                                    <h5>Mejoras relativas a la Region: </h5>
                                    <span ng-if="$ctrl.porcentajeRelativo < 1">
                                    <span style="color: red; font-size: x-large; font-weight: 600;">
                                        {{ $ctrl.porcentajeRelativo}} %
                                    </span>
                                         Subvencion relativa a la region
                                    </span>

                                    <span ng-if="$ctrl.porcentajeRelativo >= 1">
                                    <span style="color: limegreen; font-size: x-large; font-weight: 600;">
                                       + {{ $ctrl.porcentajeRelativo }} %
                                    </span>
                                         Subvencion relativa a la region
                                    </span>


                                </div>

                            </a>
                        </div>

                    </div>
                </div>

            </ul>


            <script>


                function hidediv(evt) {
                    var x;
                    x = document.getElementsByClassName("ng-scope")

                    for (i = 0; i < x.length; i++) {

                        var a = x[i];
                        if ((a.innerText == "" || (/^\s+$/.test(a.innerText))) && a.tagName == "DIV") {
                            a.style.display = 'none';
                        } else {
                            a.style.display = 'block'
                        }
                        ;
                    }
                }


            </script>
        </div>
    </body>
</html>